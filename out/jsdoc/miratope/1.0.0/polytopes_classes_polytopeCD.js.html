<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>polytopes/classes/polytopeCD.js - Documentation</title><script src="scripts/prettify/prettify.js"></script><script src="scripts/prettify/lang-css.js"></script><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><link type="text/css" rel="stylesheet" href="styles/prettify.css"><link type="text/css" rel="stylesheet" href="styles/jsdoc.css"><script src="scripts/nav.js" defer="defer"></script><meta name="viewport" content="width=device-width,initial-scale=1"></head><body><input type="checkbox" id="nav-trigger" class="nav-trigger"> <label for="nav-trigger" class="navicon-button x"><div class="navicon"></div></label> <label for="nav-trigger" class="overlay"></label><nav><input type="text" id="nav-search" placeholder="Search"><h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/officialurl/miratope" target="_blank" class="menu-item" id="repository">Github repo</a></h2><h3>Classes</h3><ul><li><a href="AvlNode.html">AvlNode</a><ul class="methods"><li data-type="method" style="display:none"><a href="AvlNode.html#leftHeight">leftHeight</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#leftHeight">leftHeight</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#linkLeft">linkLeft</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#linkLeft">linkLeft</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#linkRight">linkRight</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#linkRight">linkRight</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#rightHeight">rightHeight</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#rightHeight">rightHeight</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#rotateLeft">rotateLeft</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#rotateLeft">rotateLeft</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#rotateRight">rotateRight</a></li><li data-type="method" style="display:none"><a href="AvlNode.html#rotateRight">rotateRight</a></li></ul></li><li></li><li><a href="AvlTree.html">AvlTree</a><ul class="methods"><li data-type="method" style="display:none"><a href="AvlTree.html#.getBalanceState">getBalanceState</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#.getBalanceState">getBalanceState</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#contains">contains</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#contains">contains</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#delete">delete</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#delete">delete</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMaximum">findMaximum</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMaximum">findMaximum</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMaximumNode">findMaximumNode</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMaximumNode">findMaximumNode</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMinimum">findMinimum</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMinimum">findMinimum</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMinimumNode">findMinimumNode</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#findMinimumNode">findMinimumNode</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#getNode">getNode</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#getNode">getNode</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#insert">insert</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#insert">insert</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#isEmpty">isEmpty</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#isEmpty">isEmpty</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#size">size</a></li><li data-type="method" style="display:none"><a href="AvlTree.html#size">size</a></li></ul></li><li></li><li><a href="Caret.html">Caret</a><ul class="methods"><li data-type="method" style="display:none"><a href="Caret.html#advance">advance</a></li><li data-type="method" style="display:none"><a href="Caret.html#advance">advance</a></li><li data-type="method" style="display:none"><a href="Caret.html#getChar">getChar</a></li><li data-type="method" style="display:none"><a href="Caret.html#getChar">getChar</a></li><li data-type="method" style="display:none"><a href="Caret.html#increment">increment</a></li><li data-type="method" style="display:none"><a href="Caret.html#increment">increment</a></li><li data-type="method" style="display:none"><a href="Caret.html#readNumber">readNumber</a></li><li data-type="method" style="display:none"><a href="Caret.html#readNumber">readNumber</a></li><li data-type="method" style="display:none"><a href="Caret.html#readUntil">readUntil</a></li><li data-type="method" style="display:none"><a href="Caret.html#readUntil">readUntil</a></li><li data-type="method" style="display:none"><a href="Caret.html#readWord">readWord</a></li><li data-type="method" style="display:none"><a href="Caret.html#readWord">readWord</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToChar">skipToChar</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToChar">skipToChar</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToContent">skipToContent</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToContent">skipToContent</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToString">skipToString</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToString">skipToString</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToStringList">skipToStringList</a></li><li data-type="method" style="display:none"><a href="Caret.html#skipToStringList">skipToStringList</a></li><li data-type="method" style="display:none"><a href="Caret.html#throwError">throwError</a></li><li data-type="method" style="display:none"><a href="Caret.html#throwError">throwError</a></li></ul></li><li></li><li><a href="Point.html">Point</a><ul class="methods"><li data-type="method" style="display:none"><a href="Point.html#.padLeft">padLeft</a></li><li data-type="method" style="display:none"><a href="Point.html#.padLeft">padLeft</a></li><li data-type="method" style="display:none"><a href="Point.html#.padRight">padRight</a></li><li data-type="method" style="display:none"><a href="Point.html#.padRight">padRight</a></li><li data-type="method" style="display:none"><a href="Point.html#.product">product</a></li><li data-type="method" style="display:none"><a href="Point.html#.product">product</a></li><li data-type="method" style="display:none"><a href="Point.html#add">add</a></li><li data-type="method" style="display:none"><a href="Point.html#add">add</a></li><li data-type="method" style="display:none"><a href="Point.html#addCoordinate">addCoordinate</a></li><li data-type="method" style="display:none"><a href="Point.html#addCoordinate">addCoordinate</a></li><li data-type="method" style="display:none"><a href="Point.html#clone">clone</a></li><li data-type="method" style="display:none"><a href="Point.html#clone">clone</a></li><li data-type="method" style="display:none"><a href="Point.html#dimensions">dimensions</a></li><li data-type="method" style="display:none"><a href="Point.html#dimensions">dimensions</a></li><li data-type="method" style="display:none"><a href="Point.html#project">project</a></li><li data-type="method" style="display:none"><a href="Point.html#project">project</a></li><li data-type="method" style="display:none"><a href="Point.html#scale">scale</a></li><li data-type="method" style="display:none"><a href="Point.html#scale">scale</a></li><li data-type="method" style="display:none"><a href="Point.html#subtract">subtract</a></li><li data-type="method" style="display:none"><a href="Point.html#subtract">subtract</a></li></ul></li><li></li><li><a href="PolytopeC.html">PolytopeC</a><ul class="methods"><li data-type="method" style="display:none"><a href="PolytopeC.html#faceToVertices">faceToVertices</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#faceToVertices">faceToVertices</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#gravicenter">gravicenter</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#gravicenter">gravicenter</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#recenter">recenter</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#recenter">recenter</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#scale">scale</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#scale">scale</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#setSpaceDimensions">setSpaceDimensions</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#setSpaceDimensions">setSpaceDimensions</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#toPolytopeC">toPolytopeC</a></li><li data-type="method" style="display:none"><a href="PolytopeC.html#toPolytopeC">toPolytopeC</a></li></ul></li><li></li><li><a href="Scene.html">Scene</a><ul class="methods"><li data-type="method" style="display:none"><a href="Scene.html#add">add</a></li><li data-type="method" style="display:none"><a href="Scene.html#add">add</a></li></ul></li><li></li><li><a href="SweeplineEdge.html">SweeplineEdge</a><ul class="methods"><li data-type="method" style="display:none"><a href="SweeplineEdge.html#getId">getId</a></li><li data-type="method" style="display:none"><a href="SweeplineEdge.html#getId">getId</a></li><li data-type="method" style="display:none"><a href="SweeplineEdge.html#rightVertex">rightVertex</a></li><li data-type="method" style="display:none"><a href="SweeplineEdge.html#rightVertex">rightVertex</a></li><li data-type="method" style="display:none"><a href="SweeplineEdge.html#updateRedirectTable">updateRedirectTable</a></li><li data-type="method" style="display:none"><a href="SweeplineEdge.html#updateRedirectTable">updateRedirectTable</a></li></ul></li><li></li></ul><h3>Namespaces</h3><ul><li><a href="BalanceState.html">BalanceState</a></li><li></li><li><a href="ConstructionNodeType.html">ConstructionNodeType</a></li><li></li><li><a href="Space.html">Space</a><ul class="methods"><li data-type="method" style="display:none"><a href="Space.html#.area">area</a></li><li data-type="method" style="display:none"><a href="Space.html#.area">area</a></li><li data-type="method" style="display:none"><a href="Space.html#.distance">distance</a></li><li data-type="method" style="display:none"><a href="Space.html#.distance">distance</a></li><li data-type="method" style="display:none"><a href="Space.html#.distanceSq">distanceSq</a></li><li data-type="method" style="display:none"><a href="Space.html#.distanceSq">distanceSq</a></li><li data-type="method" style="display:none"><a href="Space.html#.intersect">intersect</a></li><li data-type="method" style="display:none"><a href="Space.html#.intersect">intersect</a></li><li data-type="method" style="display:none"><a href="Space.html#.sameSlope">sameSlope</a></li><li data-type="method" style="display:none"><a href="Space.html#.sameSlope">sameSlope</a></li></ul></li><li></li><li><a href="Translation.html">Translation</a><ul class="methods"><li data-type="method" style="display:none"><a href="Translation.html#.addAdjective">addAdjective</a></li><li data-type="method" style="display:none"><a href="Translation.html#.addAdjective">addAdjective</a></li><li data-type="method" style="display:none"><a href="Translation.html#.elementName">elementName</a></li><li data-type="method" style="display:none"><a href="Translation.html#.elementName">elementName</a></li><li data-type="method" style="display:none"><a href="Translation.html#.greekPrefix">greekPrefix</a></li><li data-type="method" style="display:none"><a href="Translation.html#.greekPrefix">greekPrefix</a></li></ul></li><li></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-dependencies.html">How to update Miratope's dependencies?</a></li><li><a href="tutorial-translation_.html">How to translate Miratope?</a></li></ul><h3>Global</h3><ul><li><a href="global.html#BalanceState%255Bundefined%255D">BalanceState[undefined]</a></li><li><a href="global.html#CNType%255Bundefined%255D">CNType[undefined]</a></li></ul></nav><div id="main"><h1 class="page-title">polytopes/classes/polytopeCD.js</h1><section><article><pre class="prettyprint source linenums"><code>"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PolytopeCD = void 0;
const graphNode_1 = require("../../data structures/graphNode");
const polytopeTypes_1 = require("../polytopeTypes");
class PolytopeCD {
    /**
     * Creates a Schläfli matrix from a Coxeter diagram
     * @param {string} diagram The input Coxeter diagram
     * @returns {number[][]} A 2D array corresponding to the CD's Schläfli matrix
     */
    static cdToMatrix(diagram) {
        if (/[a-z][a-z]/.test(diagram))
            throw new Error("Hey! I see you inputting a compound! Stop that >:[");
        if (/[#]/.test(diagram))
            throw new Error("Laces don't work yet, sorry :/");
        if (/[']/.test(diagram))
            throw new Error("Retrograde stuff doesn't work yet, sorry :/");
        diagram = diagram.replace(/-/gi, "");
        const dimen = diagram.replace(/\*.|[^a-z\u03B2]/gi, "").length;
        let alpha = 0;
        let marked = "";
        let v = false;
        for (let i = 0; i &lt; diagram.length; i++) {
            let char = diagram.charAt(i);
            check: if (/[^1234567890/ \u221E\u00D8]/.test(char)) {
                if (/\*/.test(char)) {
                    v = true;
                    break check;
                }
                if (v) {
                    v = false;
                    break check;
                }
                alpha++;
                char = (alpha + 9).toString(36);
            }
            marked = marked + char;
        }
        marked = marked.replace(/\*/gi, "");
        const pat = /(?=(([a-z]\d+[a-z])|([a-z]\d+\/\d+[a-z])|([a-z]\u221E+[a-z])|([a-z]\u00D8+[a-z])))./g;
        const angles = [];
        let match;
        while ((match = pat.exec(marked)) != null)
            angles.push(match[1]);
        const schlafl = [];
        for (let i = 0; i &lt; dimen; i++) {
            schlafl[i] = [];
            for (let j = 0; j &lt; dimen; j++) {
                schlafl[i][j] = 0;
                if (i === j) {
                    schlafl[i][j] = 2;
                }
            }
        }
        for (let i = 0; i &lt; angles.length; i++) {
            let mira1 = angles[i].charCodeAt(0) - 97;
            let mira2 = angles[i].charCodeAt(angles[i].length - 1) - 97;
            if (mira2 > mira1) {
                mira1 = angles[i].charCodeAt(angles[i].length - 1) - 97;
                mira2 = angles[i].charCodeAt(0) - 97;
            }
            let num1 = parseInt(angles[i].substring(1, angles[i].length - 1));
            let num2;
            let ang = -2 * Math.cos(Math.PI / num1);
            if (/[\u221E\u00D8]/.test(angles[i].substring(1, angles[i].length - 1))) {
                ang = -2;
            }
            if (/\//.test(angles[i])) {
                num1 = parseInt(angles[i].substring(1, angles[i].search("/")));
                num2 = parseInt(angles[i].substring(angles[i].search("/") + 1, angles[i].length - 1));
                ang = -2 * Math.cos(Math.PI / (num1 / num2));
            }
            schlafl[mira1][mira2] = ang;
            schlafl[mira2][mira1] = ang;
        }
        return schlafl;
    }
    /**
     * Returns a polytope's dimension and space shape from a Coxeter diagram
     * @param {string} diagram The input Coxeter diagram
     * @returns {number[]} An array with the first entry being the dimension and the second is 1 for spherical, 0 for euclidean, and -1 for hyperbolic (and null when something is wrong)
     */
    static spaceShape(diagram) {
        const schlafl = PolytopeCD.cdToMatrix(diagram);
        const det = Math.round(PolytopeCD.determinant(schlafl) * 1000) / 1000;
        //var space = [];
        diagram = diagram.replace(/-/gi, "");
        const dimen = diagram.replace(/\*.|[^a-z\u03B2]/gi, "").length;
        let shape = Math.sign(det);
        if (isNaN(det))
            shape = null;
        return [dimen, shape];
    }
    /**
     * Returns the determinant of a matrix.
     * @param {number[][]} diagram A matrix in the form of a 2D array
     * @returns {number} The matrix's determinant
     * @private
     * @todo Use Gaussian elimination to calculate the determinant much quicker.
     */
    static determinant(schlafl) {
        if (schlafl.length === 1) {
            if (typeof schlafl[0] === "object")
                return schlafl[0][0];
            else
                return schlafl[0];
        }
        const minors = [];
        for (let i = 0; i &lt; schlafl[0].length; i++) {
            minors[i] = [];
            for (let j = 0; j &lt; schlafl[0].length; j++) {
                if (j === 0)
                    continue;
                if (!minors[i][j - 1])
                    minors[i][j - 1] = [];
                for (let k = 0; k &lt; schlafl[0].length; k++) {
                    if (k === i)
                        continue;
                    minors[i][j - 1].push(schlafl[j][k]);
                }
            }
        }
        let multiplier = 1;
        const subResults = [];
        for (let i = 0; i &lt; schlafl.length; i++) {
            subResults[i] =
                multiplier * schlafl[0][i] * PolytopeCD.determinant(minors[i]);
            multiplier *= -1;
        }
        return subResults.reduce(function (sum, val) {
            return sum + val;
        }, 0);
    }
}
exports.PolytopeCD = PolytopeCD;
/**
 * Creates a graph from the vertices and edges of a polyhedron.
 * Adds labels edges based on their adjacent faces.
 * @todo Could this be changed to work for higher/lower dimensions too?
 * @returns {GraphNode[]} The graph of the polytope.
 */
polytopeTypes_1.PolytopeB.prototype.polytopeToGraph = function () {
    const P = this.toPolytopeC();
    if (!P.elementList[0] || !P.elementList[1] || !P.elementList[2])
        throw new RangeError("polytopeToGraph only works for 3D+!");
    const gNodes = [];
    const gLinks = [];
    for (let v = 0; v &lt; P.elementList[0].length; v++) {
        const gNode = new graphNode_1.GraphNode(v);
        gNodes.push(gNode);
    }
    for (let f = 0; f &lt; P.elementList[2].length; f++) {
        for (let e = 0; e &lt; P.elementList[2][f].length; e++) {
            const p1 = gNodes[P.elementList[1][P.elementList[2][f][e]][0]];
            const p2 = gNodes[P.elementList[1][P.elementList[2][f][e]][1]];
            if (gLinks.includes([p1, p2])) {
                p1.labels[p1.neighbors.indexOf(p2)] = f;
                p2.labels[p2.neighbors.indexOf(p1)] = f;
            }
            else {
                p1.connectTo(p2, f);
                gLinks.push([p1, p2]);
            }
        }
    }
    return gNodes;
};
//# sourceMappingURL=polytopeCD.js.map</code></pre></article></section></div><br class="clear"><footer>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Sat Dec 26 2020 20:10:58 GMT-0600 (Central Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.</footer><script>prettyPrint()</script><script src="scripts/polyfill.js"></script><script src="scripts/linenumber.js"></script><script src="scripts/search.js" defer="defer"></script><script src="scripts/collapse.js" defer="defer"></script></body></html>